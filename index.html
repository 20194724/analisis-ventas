<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard de Ventas</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #FAFAF9;
  --white: #ffffff;
  --border: #E8E8E5;
  --text: #1A1A18;
  --text2: #5C5C58;
  --text3: #A0A09A;
  --blue: #2563EB;
  --blue-l: #EFF6FF;
  --orange: #EA580C;
  --orange-l: #FFF7ED;
  --green: #16A34A;
  --green-l: #F0FDF4;
  --red: #DC2626;
  --red-l: #FEF2F2;
  --yellow: #D97706;
  --yellow-l: #FFFBEB;
  --proj: #8B5CF6;
  --proj-l: #F5F3FF;
  --pink: #DB2777;
  --pink-l: #FDF2F8;
  --teal: #0D9488;
  --teal-l: #F0FDFA;
  --radius: 10px;
  --sh: 0 1px 3px rgba(0,0,0,0.05), 0 1px 2px rgba(0,0,0,0.03);
}

body { font-family: 'DM Sans', -apple-system, sans-serif; background: var(--bg); color: var(--text); font-size: 14px; line-height: 1.55; -webkit-font-smoothing: antialiased; }

.page { max-width: 980px; margin: 0 auto; padding: 52px 36px 100px; }
@media (max-width: 700px) { .page { padding: 28px 16px 80px; } }

/* Header */
.page-icon { font-size: 2.2rem; margin-bottom: 8px; }
.header-row { display: flex; align-items: flex-start; justify-content: space-between; gap: 16px; flex-wrap: wrap; margin-bottom: 38px; }
.page-title { font-size: clamp(1.4rem, 4vw, 2rem); font-weight: 600; letter-spacing: -0.03em; line-height: 1.15; }
.page-sub { color: var(--text3); font-size: 13px; margin-top: 5px; font-weight: 300; }
.date-chip { background: var(--white); border: 1px solid var(--border); border-radius: 6px; padding: 5px 11px; font-size: 12px; color: var(--text2); white-space: nowrap; align-self: flex-start; }

/* KPI grid */
.kpi-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 38px; }
@media (max-width: 750px) { .kpi-grid { grid-template-columns: repeat(2, 1fr); } }
.kpi { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 15px 17px; box-shadow: var(--sh); }
.kpi-label { font-size: 10px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text3); margin-bottom: 5px; }
.kpi-value { font-size: 1.25rem; font-weight: 600; letter-spacing: -0.025em; line-height: 1.1; }
.kpi-sub { font-size: 11px; color: var(--text3); margin-top: 4px; font-weight: 300; }
.badge { display: inline-block; font-size: 10px; font-weight: 500; padding: 1px 6px; border-radius: 4px; margin-top: 5px; }
.b-green { background: var(--green-l); color: var(--green); }
.b-blue  { background: var(--blue-l);  color: var(--blue); }
.b-red   { background: var(--red-l);   color: var(--red); }
.b-yellow{ background: var(--yellow-l);color: var(--yellow); }
.b-proj  { background: var(--proj-l);  color: var(--proj); }

hr.div { border: none; border-top: 1px solid var(--border); margin: 34px 0; }

.sec { margin-bottom: 38px; }
.sec-label { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.12em; color: var(--text3); margin-bottom: 4px; }
.sec-title { font-size: 1rem; font-weight: 500; margin-bottom: 16px; }

/* Card */
.card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 22px 22px 18px; box-shadow: var(--sh); position: relative; }
.card-head { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 18px; gap: 12px; flex-wrap: wrap; }
.card-title { font-size: 13px; font-weight: 500; }
.card-sub   { font-size: 11px; color: var(--text3); margin-top: 2px; font-weight: 300; }
.legend { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
.leg { display: flex; align-items: center; gap: 5px; font-size: 11px; color: var(--text2); }
.leg-line { width: 14px; height: 2px; border-radius: 1px; }
.leg-dash { width: 14px; height: 0; border-top: 2px dashed; }
.leg-sq   { width: 9px; height: 9px; border-radius: 2px; }

svg { display: block; width: 100%; overflow: visible; }

.tt { position: absolute; background: var(--text); color: #fff; border-radius: 8px; padding: 8px 12px; font-size: 12px; pointer-events: none; opacity: 0; transition: opacity 0.1s; z-index: 30; white-space: nowrap; transform: translateX(-50%); box-shadow: 0 8px 20px rgba(0,0,0,0.18); }
.tt.show { opacity: 1; }
.tt-lbl { opacity: 0.5; font-size: 10px; margin-bottom: 2px; font-weight: 300; }
.tt-val { font-weight: 600; font-size: 13px; }
.tt-sub { opacity: 0.5; font-size: 10px; margin-top: 1px; }

.two-col   { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
.three-col { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px; }
@media (max-width: 680px) { .two-col, .three-col { grid-template-columns: 1fr; } }

.note { background: var(--proj-l); border: 1px solid rgba(139,92,246,0.2); border-radius: 8px; padding: 10px 14px; font-size: 11.5px; color: #5B21B6; margin-top: 14px; display: flex; gap: 8px; font-weight: 300; }
.note strong { font-weight: 500; }

.warn-note { background: var(--red-l); border: 1px solid rgba(220,38,38,0.18); border-radius: 8px; padding: 10px 14px; font-size: 11.5px; color: #991B1B; margin-top: 14px; display: flex; gap: 8px; font-weight: 300; }
.warn-note strong { font-weight: 500; }

/* Bar rows */
.bar-row { display: flex; flex-direction: column; gap: 9px; }
.bar-item { display: flex; align-items: center; gap: 10px; }
.bi-label { font-size: 11px; color: var(--text2); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: 400; }
.bi-track { flex: 1; background: #F1F1EE; border-radius: 4px; height: 8px; overflow: hidden; }
.bi-fill  { height: 100%; border-radius: 4px; }
.bi-val   { font-size: 11px; font-weight: 500; color: var(--text); min-width: 36px; text-align: right; }
.bi-sub   { font-size: 10px; color: var(--text3); min-width: 32px; text-align: right; }

/* Donut */
.donut-wrap { display: flex; align-items: center; justify-content: center; gap: 18px; flex-wrap: wrap; }
.donut-legend { display: flex; flex-direction: column; gap: 7px; }
.donut-leg-item { display: flex; align-items: center; gap: 7px; font-size: 12px; color: var(--text2); }
.donut-dot { width: 9px; height: 9px; border-radius: 50%; flex-shrink: 0; }
.donut-leg-val { font-weight: 500; color: var(--text); }

/* Vendor cards */
.vendor-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
@media (max-width: 600px) { .vendor-grid { grid-template-columns: 1fr; } }
.vendor-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 18px 20px; box-shadow: var(--sh); }
.vendor-name { font-size: 15px; font-weight: 600; letter-spacing: -0.01em; margin-bottom: 12px; }
.vendor-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.vs-item-label { font-size: 10px; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text3); font-weight: 500; margin-bottom: 2px; }
.vs-item-val   { font-size: 1rem; font-weight: 600; letter-spacing: -0.02em; }

/* Insights */
.insight-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
@media (max-width: 720px) { .insight-grid { grid-template-columns: 1fr; } }
.insight { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 16px 18px; box-shadow: var(--sh); }
.insight.warn { border-left: 3px solid #F59E0B; }
.insight.good { border-left: 3px solid #22C55E; }
.insight.info { border-left: 3px solid var(--blue); }
.insight.danger { border-left: 3px solid var(--red); }
.insight-icon  { font-size: 1.1rem; margin-bottom: 8px; }
.insight-title { font-size: 12px; font-weight: 600; margin-bottom: 5px; }
.insight-body  { font-size: 12px; color: var(--text2); line-height: 1.6; font-weight: 300; }
.insight-body strong { color: var(--text); font-weight: 500; }

/* Problem tag */
.prob-tag { display: inline-block; font-size: 10px; font-weight: 500; padding: 2px 7px; border-radius: 4px; background: var(--red-l); color: var(--red); }

/* Margin indicator */
.margin-bar-wrap { margin-top: 6px; }
.margin-track { height: 6px; background: #F1F1EE; border-radius: 3px; overflow: hidden; }
.margin-fill  { height: 100%; border-radius: 3px; background: var(--green); }
</style>
</head>
<body>
<div class="page">

  <!-- HEADER -->
  <div class="page-icon">üìä</div>
  <div class="header-row">
    <div>
      <h1 class="page-title">An√°lisis de Ventas</h1>
      <p class="page-sub">Noviembre 2025 ‚Äî Febrero 2026 ¬∑ 51 pedidos</p>
    </div>
    <div class="date-chip">Feb 22, 2026</div>
  </div>

  <!-- KPIs -->
  <div class="kpi-grid">
    <div class="kpi">
      <div class="kpi-label">Venta neta total</div>
      <div class="kpi-value">S/. 4,958</div>
      <div class="kpi-sub">51 pedidos</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Utilidad total</div>
      <div class="kpi-value">S/. 2,680</div>
      <div class="kpi-sub">margen promedio 53%</div>
      <div class="badge b-green">‚Üë s√≥lido</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Mejor semana</div>
      <div class="kpi-value">S/. 593</div>
      <div class="kpi-sub">S10 ¬∑ util. 63.4% margen</div>
      <div class="badge b-green">pico hist√≥rico</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Pedidos c/ problema</div>
      <div class="kpi-value">2 / 51</div>
      <div class="kpi-sub">S/. 24.00 afectados</div>
      <div class="badge b-yellow">3.9% tasa</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Ticket promedio</div>
      <div class="kpi-value">S/. 97.2</div>
      <div class="kpi-sub">utilidad prom. S/. 52.5</div>
      <div class="badge b-blue">estable</div>
    </div>
  </div>

  <hr class="div">

  <!-- WEEKLY: VENTA + UTILIDAD -->
  <div class="sec">
    <div class="sec-label">Ventas semanales</div>
    <div class="sec-title">Venta neta + Utilidad + Proyecci√≥n</div>
    <div class="card">
      <div class="card-head">
        <div>
          <div class="card-title">Venta neta vs. Utilidad por semana (S/.)</div>
          <div class="card-sub">S1‚ÄìS12 hist√≥rico ¬∑ S13‚ÄìS16 proyecci√≥n ¬∑ √°reas sombreadas = utilidad</div>
        </div>
        <div class="legend">
          <div class="leg"><div class="leg-line" style="background:var(--blue)"></div>Venta neta</div>
          <div class="leg"><div class="leg-line" style="background:var(--green)"></div>Utilidad</div>
          <div class="leg"><div class="leg-dash" style="border-color:var(--proj)"></div>Proyecci√≥n</div>
        </div>
      </div>
      <svg id="wsvg" viewBox="0 0 880 250" preserveAspectRatio="xMidYMid meet"></svg>
      <div class="tt" id="wtt"></div>
      <div class="note">
        <span>üîÆ</span>
        <span>Proyecci√≥n lineal sobre S7‚ÄìS12. <strong>S13 ‚âà S/. 748 ¬∑ S14 ‚âà S/. 819 ¬∑ S15 ‚âà S/. 890 ¬∑ S16 ‚âà S/. 961.</strong> Utilidad proyectada para marzo: <strong>~S/. 1,750</strong> si el margen se mantiene en ~53%.</span>
      </div>
    </div>
  </div>

  <!-- MONTHLY -->
  <div class="sec">
    <div class="sec-label">Ventas mensuales</div>
    <div class="sec-title">Venta neta ¬∑ Costo ¬∑ Utilidad por mes</div>
    <div class="card">
      <div class="card-head">
        <div>
          <div class="card-title">Desglose mensual (S/.)</div>
          <div class="card-sub">Barras apiladas: costo (rojo suave) + utilidad (verde)</div>
        </div>
        <div class="legend">
          <div class="leg"><div class="leg-sq" style="background:rgba(22,163,74,0.75)"></div>Utilidad</div>
          <div class="leg"><div class="leg-sq" style="background:rgba(220,38,38,0.25)"></div>Costo</div>
        </div>
      </div>
      <svg id="msvg" viewBox="0 0 880 220" preserveAspectRatio="xMidYMid meet"></svg>
      <div class="tt" id="mtt"></div>
    </div>
  </div>

  <hr class="div">

  <!-- PRODUCTOS -->
  <div class="sec">
    <div class="sec-label">Productos</div>
    <div class="sec-title">Frecuencia, utilidad y margen por modelo</div>
    <div class="two-col">

      <div class="card">
        <div class="card-head"><div>
          <div class="card-title">Modelos m√°s vendidos</div>
          <div class="card-sub">Unidades ¬∑ Utilidad total</div>
        </div></div>
        <div class="bar-row" id="prod-freq"></div>
      </div>

      <div class="card">
        <div class="card-head"><div>
          <div class="card-title">Margen % por producto</div>
          <div class="card-sub">Utilidad √∑ Venta neta promedio</div>
        </div></div>
        <div class="bar-row" id="prod-margin"></div>
      </div>

    </div>

    <div class="note" style="margin-top:14px;">
      <span>üí°</span>
      <span><strong>PERSONALIZADO</strong> tiene el margen m√°s alto (74%) y la mayor utilidad por pedido (S/. 102). <strong>CSM-B 1200</strong> es el peor (32% margen, S/. 9 de utilidad promedio en casos normales). Si puedes hacer m√°s pedidos personalizados, hazlos.</span>
    </div>
  </div>

  <hr class="div">

  <!-- VENDEDORES -->
  <div class="sec">
    <div class="sec-label">Vendedores</div>
    <div class="sec-title">Comparativa Alberto vs. Gonzalo</div>
    <div class="vendor-grid">
      <div class="vendor-card">
        <div class="vendor-name">üßë Alberto</div>
        <div class="vendor-stats">
          <div><div class="vs-item-label">Pedidos</div><div class="vs-item-val">8</div></div>
          <div><div class="vs-item-label">Venta neta</div><div class="vs-item-val">S/. 644</div></div>
          <div><div class="vs-item-label">Utilidad</div><div class="vs-item-val">S/. 350</div></div>
          <div><div class="vs-item-label">Margen</div><div class="vs-item-val">54.3%</div></div>
          <div><div class="vs-item-label">Ticket prom.</div><div class="vs-item-val">S/. 80.5</div></div>
          <div><div class="vs-item-label">Util. por ped.</div><div class="vs-item-val">S/. 43.7</div></div>
        </div>
        <div class="margin-bar-wrap">
          <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-bottom:4px;margin-top:12px;"><span>Participaci√≥n en ventas</span><span>13%</span></div>
          <div class="margin-track"><div class="margin-fill" style="width:13%;background:var(--blue)"></div></div>
        </div>
      </div>
      <div class="vendor-card">
        <div class="vendor-name">üßë Gonzalo</div>
        <div class="vendor-stats">
          <div><div class="vs-item-label">Pedidos</div><div class="vs-item-val">43</div></div>
          <div><div class="vs-item-label">Venta neta</div><div class="vs-item-val">S/. 4,315</div></div>
          <div><div class="vs-item-label">Utilidad</div><div class="vs-item-val">S/. 2,330</div></div>
          <div><div class="vs-item-label">Margen</div><div class="vs-item-val">54.0%</div></div>
          <div><div class="vs-item-label">Ticket prom.</div><div class="vs-item-val">S/. 100.3</div></div>
          <div><div class="vs-item-label">Util. por ped.</div><div class="vs-item-val">S/. 54.2</div></div>
        </div>
        <div class="margin-bar-wrap">
          <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-bottom:4px;margin-top:12px;"><span>Participaci√≥n en ventas</span><span>87%</span></div>
          <div class="margin-track"><div class="margin-fill" style="width:87%;"></div></div>
        </div>
      </div>
    </div>
    <div class="warn-note">
      <span>‚ö†Ô∏è</span>
      <span>Alberto tiene pr√°cticamente <strong>0 ventas desde diciembre</strong>. Su ticket promedio (S/. 80.5) es S/. 20 menor que Gonzalo. Sin embargo, su <strong>margen es casi id√©ntico (54.3%)</strong> ‚Äî el problema no es eficiencia, es volumen. Necesita m√°s pedidos asignados.</span>
    </div>
  </div>

  <hr class="div">

  <!-- PROBLEMAS -->
  <div class="sec">
    <div class="sec-label">Incidencias</div>
    <div class="sec-title">Pedidos con problemas registrados</div>
    <div class="two-col">
      <div class="card">
        <div class="card-head"><div>
          <div class="card-title">Historial de problemas</div>
          <div class="card-sub">2 incidencias ¬∑ S/. 24.00 en costos adicionales</div>
        </div></div>
        <div style="display:flex;flex-direction:column;gap:12px;">
          <div style="display:flex;align-items:flex-start;gap:12px;padding:12px;background:var(--red-l);border-radius:8px;border:1px solid rgba(220,38,38,0.12);">
            <div style="font-size:1.2rem;flex-shrink:0;">üì¶</div>
            <div>
              <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                <span style="font-size:12px;font-weight:500;">#33 ¬∑ Anthony Flores</span>
                <span class="prob-tag">CAMBIO</span>
              </div>
              <div style="font-size:11.5px;color:var(--text2);font-weight:300;">N-N 1200 ¬∑ Feb 5, 2026 ¬∑ Costo adicional: <strong style="color:var(--red)">S/. 12.00</strong></div>
            </div>
          </div>
          <div style="display:flex;align-items:flex-start;gap:12px;padding:12px;background:var(--yellow-l);border-radius:8px;border:1px solid rgba(217,119,6,0.15);">
            <div style="font-size:1.2rem;flex-shrink:0;">üîÄ</div>
            <div>
              <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                <span style="font-size:12px;font-weight:500;">#44 ¬∑ Mery Pamela Santos</span>
                <span style="display:inline-block;font-size:10px;font-weight:500;padding:2px 7px;border-radius:4px;background:var(--yellow-l);color:var(--yellow);border:1px solid rgba(217,119,6,0.2);">REDIRECCIONAMIENTO</span>
              </div>
              <div style="font-size:11.5px;color:var(--text2);font-weight:300;">OP-L-B 890 ¬∑ Feb 16, 2026 ¬∑ Costo adicional: <strong style="color:var(--yellow)">S/. 12.00</strong></div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-head"><div>
          <div class="card-title">Tasa de problemas</div>
          <div class="card-sub">Por courier ¬∑ pedidos afectados</div>
        </div></div>
        <div style="display:flex;flex-direction:column;gap:14px;">
          <div>
            <div style="font-size:11px;color:var(--text2);margin-bottom:6px;">Tasa global de incidencias</div>
            <div style="display:flex;align-items:center;gap:10px;">
              <div style="flex:1;height:10px;background:#F1F1EE;border-radius:5px;overflow:hidden;">
                <div style="width:3.9%;height:100%;background:var(--red);border-radius:5px;"></div>
              </div>
              <span style="font-size:12px;font-weight:500;color:var(--text);">3.9%</span>
            </div>
            <div style="font-size:11px;color:var(--text3);margin-top:4px;font-weight:300;">2 de 51 pedidos</div>
          </div>
          <div style="background:var(--bg);border-radius:8px;padding:12px;font-size:12px;color:var(--text2);line-height:1.7;">
            <div style="font-weight:500;color:var(--text);margin-bottom:6px;">Ambos problemas ocurrieron en:</div>
            <div>¬∑ <strong>DINSIDES</strong> (cambio) ‚Äî 1 de 14 pedidos = 7.1%</div>
            <div>¬∑ <strong>SHALOM</strong> (redireccionamiento) ‚Äî 1 de 11 pedidos = 9.1%</div>
            <div style="margin-top:8px;color:var(--text3);font-size:11px;">NOSOTROS, IN DRVER y OLVA: 0 incidencias.</div>
          </div>
          <div style="font-size:11.5px;color:var(--text2);background:var(--green-l);border-radius:8px;padding:10px 12px;border:1px solid rgba(22,163,74,0.15);font-weight:300;">
            ‚úÖ La tasa de 3.9% es baja. Si crece por encima del 8‚Äì10%, ser√≠a se√±al de alerta operativa.
          </div>
        </div>
      </div>
    </div>
  </div>

  <hr class="div">

  <!-- P√öBLICO -->
  <div class="sec">
    <div class="sec-label">P√∫blico</div>
    <div class="sec-title">¬øQui√©n te compra?</div>
    <div class="three-col">

      <div class="card">
        <div class="card-title" style="margin-bottom:16px;">G√©nero</div>
        <div class="donut-wrap">
          <svg viewBox="0 0 120 120" width="100" height="100" style="flex-shrink:0">
            <circle cx="60" cy="60" r="44" fill="none" stroke="#F5F5F3" stroke-width="16"/>
            <circle cx="60" cy="60" r="44" fill="none" stroke="var(--pink)" stroke-width="16"
              stroke-dasharray="140.2 136.7" stroke-dashoffset="34.9"/>
            <circle cx="60" cy="60" r="44" fill="none" stroke="var(--blue)" stroke-width="16"
              stroke-dasharray="129.4 147.5" stroke-dashoffset="-105.3"/>
            <circle cx="60" cy="60" r="44" fill="none" stroke="#E8E8E5" stroke-width="16"
              stroke-dasharray="8.6 268.1" stroke-dashoffset="-234.7"/>
            <text x="60" y="55" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="13" font-weight="600" fill="#1A1A18">51</text>
            <text x="60" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#A0A09A">pedidos</text>
          </svg>
          <div class="donut-legend">
            <div class="donut-leg-item"><div class="donut-dot" style="background:var(--pink)"></div><div><div class="donut-leg-val">Mujeres</div><div>26 ¬∑ 51%</div></div></div>
            <div class="donut-leg-item"><div class="donut-dot" style="background:var(--blue)"></div><div><div class="donut-leg-val">Hombres</div><div>24 ¬∑ 47%</div></div></div>
            <div class="donut-leg-item"><div class="donut-dot" style="background:#E8E8E5"></div><div><div class="donut-leg-val">N/D</div><div>1 ¬∑ 2%</div></div></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title" style="margin-bottom:16px;">Ubicaci√≥n</div>
        <div class="donut-wrap">
          <svg viewBox="0 0 120 120" width="100" height="100" style="flex-shrink:0">
            <circle cx="60" cy="60" r="44" fill="none" stroke="#F5F5F3" stroke-width="16"/>
            <circle cx="60" cy="60" r="44" fill="none" stroke="var(--teal)" stroke-width="16"
              stroke-dasharray="184.3 92.6" stroke-dashoffset="34.9"/>
            <circle cx="60" cy="60" r="44" fill="none" stroke="var(--orange)" stroke-width="16"
              stroke-dasharray="92.6 184.3" stroke-dashoffset="-149.4"/>
            <text x="60" y="55" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="13" font-weight="600" fill="#1A1A18">67%</text>
            <text x="60" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#A0A09A">provincia</text>
          </svg>
          <div class="donut-legend">
            <div class="donut-leg-item"><div class="donut-dot" style="background:var(--teal)"></div><div><div class="donut-leg-val">Provincia</div><div>34 ¬∑ 67%</div></div></div>
            <div class="donut-leg-item"><div class="donut-dot" style="background:var(--orange)"></div><div><div class="donut-leg-val">Lima</div><div>17 ¬∑ 33%</div></div></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title" style="margin-bottom:16px;">G√©nero √ó Ubicaci√≥n</div>
        <div style="display:flex;flex-direction:column;gap:14px;">
          <div>
            <div style="display:flex;justify-content:space-between;font-size:11px;margin-bottom:5px;">
              <span style="color:var(--pink);font-weight:500;">‚ôÄ Mujeres (26)</span>
            </div>
            <div style="display:flex;height:9px;border-radius:5px;overflow:hidden;">
              <div style="width:23%;background:var(--pink);opacity:0.45;"></div>
              <div style="width:77%;background:var(--pink);"></div>
            </div>
            <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-top:3px;">
              <span>Lima: 6 (23%)</span><span>Prov: 20 (77%)</span>
            </div>
          </div>
          <div>
            <div style="display:flex;justify-content:space-between;font-size:11px;margin-bottom:5px;">
              <span style="color:var(--blue);font-weight:500;">‚ôÇ Hombres (24)</span>
            </div>
            <div style="display:flex;height:9px;border-radius:5px;overflow:hidden;">
              <div style="width:46%;background:var(--blue);opacity:0.45;"></div>
              <div style="width:54%;background:var(--blue);"></div>
            </div>
            <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-top:3px;">
              <span>Lima: 11 (46%)</span><span>Prov: 13 (54%)</span>
            </div>
          </div>
          <div style="background:var(--bg);border-radius:6px;padding:10px;font-size:11px;color:var(--text2);line-height:1.6;">
            Mujeres = <strong>77% provincia</strong>. Hombres m√°s balanceados (54/46). Provincia es tu mercado core.
          </div>
        </div>
      </div>

    </div>
  </div>

  <hr class="div">

  <!-- INSIGHTS -->
  <div class="sec">
    <div class="sec-label">An√°lisis</div>
    <div class="sec-title">Lo que quiz√°s no est√°s viendo</div>
    <div class="insight-grid">
      <div class="insight danger">
        <div class="insight-icon">üìâ</div>
        <div class="insight-title">S2 fue tu √∫nica semana en p√©rdida</div>
        <div class="insight-body">La semana 17‚Äì23 Nov tuvo <strong>utilidad negativa (‚ÄìS/. 30)</strong> por el pedido de Gal (CSM-B 1200 a S/. 0 con costo de S/. 40). Un solo pedido mal priceado hundi√≥ toda la semana.</div>
      </div>
      <div class="insight good">
        <div class="insight-icon">üí∞</div>
        <div class="insight-title">PERSONALIZADO es tu producto m√°s rentable</div>
        <div class="insight-body">Con <strong>74% de margen y S/. 102 de utilidad por pedido</strong>, casi duplica el rendimiento del resto. Melissa Barros gener√≥ S/. 180 de utilidad sola. Prioriza este tipo de pedidos.</div>
      </div>
      <div class="insight warn">
        <div class="insight-icon">üì¶</div>
        <div class="insight-title">CSM-B 1200: tu producto menos rentable</div>
        <div class="insight-body">Solo <strong>31.5% de margen</strong>, el peor de toda tu l√≠nea. Si el cliente normal paga S/. 94, solo quedan ~S/. 18 de ganancia real. Considera subir el precio o descontinuarlo.</div>
      </div>
      <div class="insight info">
        <div class="insight-icon">üìà</div>
        <div class="insight-title">Tu margen mejor√≥ con el tiempo</div>
        <div class="insight-body">Noviembre: <strong>40% margen</strong>. Diciembre: 58%. Febrero: 56%. No es solo que vendes m√°s ‚Äî tambi√©n est√°s siendo m√°s eficiente. Probablemente costos de costo/producto bajaron o el mix mejor√≥.</div>
      </div>
      <div class="insight warn">
        <div class="insight-icon">üåç</div>
        <div class="insight-title">Provincia = 67% de clientes, mayor riesgo log√≠stico</div>
        <div class="insight-body">DINSIDES y SHALOM, tus dos couriers de provincia, son los √∫nicos con incidencias registradas. A m√°s volumen provincial, m√°s exposici√≥n. Vale negociar mejores condiciones o revisar sus SLAs.</div>
      </div>
      <div class="insight good">
        <div class="insight-icon">üÜï</div>
        <div class="insight-title">Los modelos 890: nueva l√≠nea prometedora</div>
        <div class="insight-body">Aparecieron en febrero con <strong>5 ventas y m√°rgenes de 52‚Äì54%</strong>, similares a la l√≠nea 1200. Si el precio de costo es menor y el precio de venta compite bien, pueden abrir un nuevo segmento.</div>
      </div>
    </div>
  </div>

</div>

<script>
/* ‚îÄ‚îÄ DATA ‚îÄ‚îÄ */
const weekly = [
  {s:"S1", r:"10‚Äì16 Nov",  ped:1,  tot:80,    util:41.97,  proj:false},
  {s:"S2", r:"17‚Äì23 Nov",  ped:2,  tot:50,    util:-30.06, proj:false},
  {s:"S3", r:"24‚Äì30 Nov",  ped:5,  tot:457.7, util:223.52, proj:false},
  {s:"S4", r:"01‚Äì07 Dic",  ped:3,  tot:457,   util:266.85, proj:false},
  {s:"S5", r:"08‚Äì14 Dic",  ped:2,  tot:195,   util:118.94, proj:false},
  {s:"S6", r:"15‚Äì21 Dic",  ped:6,  tot:569.2, util:331.03, proj:false},
  {s:"S7", r:"22‚Äì28 Dic",  ped:2,  tot:173.5, util:93.44,  proj:false},
  {s:"S8", r:"12‚Äì18 Ene",  ped:1,  tot:94,    util:45.47,  proj:false},
  {s:"S9", r:"26 Ene‚Äì01 Feb", ped:7, tot:676.2, util:347.46, proj:false},
  {s:"S10",r:"02‚Äì08 Feb",  ped:8,  tot:935,   util:592.69, proj:false},
  {s:"S11",r:"09‚Äì15 Feb",  ped:6,  tot:560.3, util:277.62, proj:false},
  {s:"S12",r:"16‚Äì22 Feb",  ped:8,  tot:710,   util:370.57, proj:false},
  {s:"S13",r:"23 Feb‚Äì01 Mar",ped:null,tot:748, util:396,   proj:true},
  {s:"S14",r:"02‚Äì08 Mar",  ped:null,tot:819,  util:433,    proj:true},
  {s:"S15",r:"09‚Äì15 Mar",  ped:null,tot:890,  util:472,    proj:true},
  {s:"S16",r:"16‚Äì22 Mar",  ped:null,tot:961,  util:509,    proj:true},
];

const monthly = [
  {m:"Nov", nombre:"Nov 2025",  ped:8,  tot:587.7,  costo:352.27, util:235.43, margen:40.1},
  {m:"Dic", nombre:"Dic 2025",  ped:13, tot:1394.7, costo:584.45, util:810.26, margen:58.1},
  {m:"Ene", nombre:"Ene 2026",  ped:8,  tot:770.2,  costo:377.27, util:392.93, margen:51.0},
  {m:"Feb", nombre:"Feb 2026",  ped:22, tot:2205.9, costo:965.03, util:1240.88,margen:56.3},
];

const prodFreq = [
  {name:"OP-L-N 1200", count:11, util:503.3},
  {name:"PERSONALIZADO",count:4,  util:409.7},
  {name:"OP-L-B 1200", count:5,  util:277.1},
  {name:"JJK-N 1200",  count:4,  util:182.5},
  {name:"DS-N 1200",   count:4,  util:182.3},
  {name:"N-N 1200",    count:4,  util:169.3},
  {name:"DS-B 1200",   count:3,  util:143.1},
  {name:"CSM-B 1200",  count:4,  util:73.8},
];

const prodMargin = [
  {name:"PERSONALIZADO",  margen:73.9},
  {name:"ST-N 1200",      margen:57.4},
  {name:"OP-L-B 1200",    margen:56.5},
  {name:"ST-B 1200",      margen:56.5},
  {name:"N-B 1200",       margen:55.5},
  {name:"DB-B 1200",      margen:54.2},
  {name:"JJK-B 890",      margen:54.0},
  {name:"DS-B 1200",      margen:55.2},
  {name:"N-N 1200",       margen:51.4},
  {name:"CSM-B 1200",     margen:31.5},
];

const fmt  = n => Math.round(n).toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');
const fmtD = n => n.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,',');

/* ‚îÄ‚îÄ BAR ROWS ‚îÄ‚îÄ */
function renderBars(id, data, maxVal, fillFn, valFn, subFn) {
  const el = document.getElementById(id); if (!el) return;
  el.innerHTML = data.map(d => {
    const pct = (valFn(d) / maxVal * 100).toFixed(1);
    return `<div class="bar-item">
      <div class="bi-label" style="min-width:110px">${d.name}</div>
      <div class="bi-track"><div class="bi-fill" style="width:${pct}%;background:${fillFn(d)}"></div></div>
      ${subFn ? `<div class="bi-sub">${subFn(d)}</div>` : ''}
      <div class="bi-val">${fmtD(valFn(d))}</div>
    </div>`;
  }).join('');
}

renderBars('prod-freq',   prodFreq,   503.3, ()=>'var(--blue)',  d=>d.util,   d=>`√ó${d.count}`);
renderBars('prod-margin', prodMargin, 74,    d => d.margen >= 55 ? 'var(--green)' : d.margen >= 45 ? 'var(--blue)' : 'var(--red)', d=>d.margen, null);

/* ‚îÄ‚îÄ WEEKLY CHART: venta + utilidad ‚îÄ‚îÄ */
(function(){
  const svg = document.getElementById('wsvg');
  const W=880, H=250, pl=50, pr=20, pt=22, pb=36;
  const cW=W-pl-pr, cH=H-pt-pb;
  const maxV = Math.max(...weekly.map(d=>d.tot)) * 1.18;
  const n = weekly.length;
  const xp = i => pl + (i/(n-1))*cW;
  const yp = v => pt + cH - (Math.max(0,v)/maxV)*cH;
  const hist = weekly.filter(d=>!d.proj);
  const hi = hist.length - 1;

  let h = `<defs>
    <linearGradient id="totg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#2563EB" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#2563EB" stop-opacity="0"/>
    </linearGradient>
    <linearGradient id="utilg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#16A34A" stop-opacity="0.15"/>
      <stop offset="100%" stop-color="#16A34A" stop-opacity="0"/>
    </linearGradient>
    <linearGradient id="projg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#8B5CF6" stop-opacity="0.06"/>
      <stop offset="100%" stop-color="#8B5CF6" stop-opacity="0"/>
    </linearGradient>
  </defs>`;

  // Grid
  [0,.25,.5,.75,1].forEach(f=>{
    const y=yp(maxV*f);
    h+=`<line x1="${pl}" y1="${y}" x2="${W-pr}" y2="${y}" stroke="#EBEBEA" stroke-width="1"/>`;
    if(f>0) h+=`<text x="${pl-6}" y="${y+4}" fill="#C8C8C2" font-size="9" text-anchor="end" font-family="DM Sans,sans-serif">${fmt(maxV*f)}</text>`;
  });

  // Total area hist
  let hArea=`M${xp(0)},${pt+cH}`;
  hist.forEach((_,i)=>hArea+=` L${xp(i)},${yp(hist[i].tot)}`);
  hArea+=` L${xp(hi)},${pt+cH}Z`;
  h+=`<path d="${hArea}" fill="url(#totg)"/>`;

  // Util area hist
  let uArea=`M${xp(0)},${pt+cH}`;
  hist.forEach((_,i)=>uArea+=` L${xp(i)},${yp(hist[i].util)}`);
  uArea+=` L${xp(hi)},${pt+cH}Z`;
  h+=`<path d="${uArea}" fill="url(#utilg)"/>`;

  // Proj area
  let pArea=`M${xp(hi)},${pt+cH} L${xp(hi)},${yp(weekly[hi].tot)}`;
  for(let i=hist.length;i<n;i++) pArea+=` L${xp(i)},${yp(weekly[i].tot)}`;
  pArea+=` L${xp(n-1)},${pt+cH}Z`;
  h+=`<path d="${pArea}" fill="url(#projg)"/>`;

  // Lines
  h+=`<path d="${hist.map((_,i)=>`${i?'L':'M'}${xp(i)},${yp(hist[i].tot)}`).join(' ')}" fill="none" stroke="#2563EB" stroke-width="2" stroke-linejoin="round" stroke-linecap="round"/>`;
  h+=`<path d="${hist.map((_,i)=>`${i?'L':'M'}${xp(i)},${yp(hist[i].util)}`).join(' ')}" fill="none" stroke="#16A34A" stroke-width="1.8" stroke-linejoin="round" stroke-linecap="round"/>`;

  let pLine=`M${xp(hi)},${yp(weekly[hi].tot)}`;
  for(let i=hist.length;i<n;i++) pLine+=` L${xp(i)},${yp(weekly[i].tot)}`;
  h+=`<path d="${pLine}" fill="none" stroke="#8B5CF6" stroke-width="2" stroke-dasharray="5,4" stroke-linejoin="round"/>`;

  // Divider
  const dx=xp(hi);
  h+=`<line x1="${dx}" y1="${pt}" x2="${dx}" y2="${pt+cH}" stroke="#E0E0DC" stroke-width="1" stroke-dasharray="3,3"/>`;
  h+=`<text x="${dx+5}" y="${pt+11}" fill="#C0C0BA" font-size="8.5" font-family="DM Sans,sans-serif">proyecci√≥n ‚Üí</text>`;

  // Dots
  weekly.forEach((d,i)=>{
    const x=xp(i), y=yp(d.tot), c=d.proj?'#8B5CF6':'#2563EB';
    h+=`<circle cx="${x}" cy="${y}" r="${d.proj?2.8:3.5}" fill="${d.proj?'white':c}" stroke="${c}" stroke-width="${d.proj?1.5:0}"/>`;
    if(!d.proj) h+=`<circle cx="${x}" cy="${yp(d.util)}" r="2.5" fill="#16A34A"/>`;
    h+=`<circle cx="${x}" cy="${y}" r="10" fill="transparent" class="wpt" data-i="${i}" style="cursor:default"/>`;
    h+=`<text x="${x}" y="${H-pb+13}" fill="${d.proj?'#C8C8C2':'#B0B0AA'}" font-size="8" text-anchor="middle" font-family="DM Sans,sans-serif">${d.s}</text>`;
  });

  svg.innerHTML=h;
  const tt=document.getElementById('wtt');
  svg.querySelectorAll('.wpt').forEach(el=>{
    el.addEventListener('mouseenter',()=>{
      const i=+el.getAttribute('data-i'), d=weekly[i];
      const r=svg.getBoundingClientRect();
      const x=xp(i)/W*r.width, y=yp(d.tot)/H*r.height;
      const margen = d.tot>0 ? (d.util/d.tot*100).toFixed(1) : '‚Äî';
      tt.innerHTML=`<div class="tt-lbl">${d.s} ¬∑ ${d.r}</div><div class="tt-val">S/. ${fmtD(d.tot)}</div><div class="tt-sub">${d.proj?'üîÆ proyecci√≥n':`Util: S/. ${fmtD(d.util)} ¬∑ Margen: ${margen}%`}</div>`;
      tt.style.left=x+'px'; tt.style.top=(y-68)+'px'; tt.classList.add('show');
    });
    el.addEventListener('mouseleave',()=>tt.classList.remove('show'));
  });
})();

/* ‚îÄ‚îÄ MONTHLY STACKED BAR ‚îÄ‚îÄ */
(function(){
  const svg=document.getElementById('msvg');
  const W=880,H=220,pl=50,pr=20,pt=18,pb=44;
  const cW=W-pl-pr,cH=H-pt-pb;
  const maxV=Math.max(...monthly.map(d=>d.tot))*1.18;
  const slot=cW/monthly.length, bw=slot*0.38;
  const yp=v=>pt+cH-(v/maxV)*cH;

  let h='';
  [0,.25,.5,.75,1].forEach(f=>{
    const y=yp(maxV*f);
    h+=`<line x1="${pl}" y1="${y}" x2="${W-pr}" y2="${y}" stroke="#EBEBEA" stroke-width="1"/>`;
    if(f>0) h+=`<text x="${pl-6}" y="${y+4}" fill="#C8C8C2" font-size="9" text-anchor="end" font-family="DM Sans,sans-serif">${fmt(maxV*f)}</text>`;
  });

  monthly.forEach((d,i)=>{
    const x=pl+i*slot+(slot-bw)/2;
    const costoH=(d.costo/maxV)*cH, utilH=(d.util/maxV)*cH;
    const costoY=pt+cH-costoH-utilH, utilY=pt+cH-utilH;

    h+=`<rect x="${x}" y="${costoY}" width="${bw}" height="${costoH}" fill="rgba(220,38,38,0.18)" rx="0"/>`;
    h+=`<rect x="${x}" y="${utilY}"  width="${bw}" height="${utilH}"  fill="rgba(22,163,74,0.75)"  rx="5" ry="5"/>`;
    // fix bottom corners
    h+=`<rect x="${x}" y="${utilY+utilH-6}" width="${bw}" height="6" fill="rgba(22,163,74,0.75)"/>`;

    h+=`<rect x="${pl+i*slot}" y="${pt}" width="${slot}" height="${cH}" fill="transparent" class="mpt" data-i="${i}" style="cursor:default"/>`;
    h+=`<text x="${x+bw/2}" y="${H-pb+16}" fill="#AEAEA8" font-size="12" text-anchor="middle" font-family="DM Sans,sans-serif" font-weight="500">${d.m}</text>`;
    h+=`<text x="${x+bw/2}" y="${costoY-7}" fill="#64748B" font-size="9.5" text-anchor="middle" font-family="DM Sans,sans-serif" font-weight="500">S/. ${fmt(d.tot)}</text>`;
    if(utilH>18) h+=`<text x="${x+bw/2}" y="${utilY+utilH/2+4}" fill="white" font-size="9" text-anchor="middle" font-family="DM Sans,sans-serif" opacity="0.95">${d.margen}%</text>`;
  });

  svg.innerHTML=h;
  const tt=document.getElementById('mtt');
  svg.querySelectorAll('.mpt').forEach(el=>{
    el.addEventListener('mouseenter',()=>{
      const i=+el.getAttribute('data-i'),d=monthly[i];
      const cx=pl+i*slot+slot/2, cy=yp(d.tot);
      const r=svg.getBoundingClientRect();
      tt.innerHTML=`<div class="tt-lbl">${d.nombre} ¬∑ ${d.ped} pedidos</div><div class="tt-val">S/. ${fmtD(d.tot)}</div><div class="tt-sub">Util: S/. ${fmtD(d.util)} ¬∑ Costo: S/. ${fmtD(d.costo)} ¬∑ Margen: ${d.margen}%</div>`;
      tt.style.left=(cx/W*r.width)+'px'; tt.style.top=((cy/H*r.height)-72)+'px'; tt.classList.add('show');
    });
    el.addEventListener('mouseleave',()=>tt.classList.remove('show'));
  });
})();
</script>
</body>
</html>
